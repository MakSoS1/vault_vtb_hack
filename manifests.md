# Манифесты Kubernetes

Проект **Secret Vault** развертывается с помощью нескольких манифестов Kubernetes, которые управляют каждым микросервисом и настройками инфраструктуры. Эти манифесты обеспечивают отказоустойчивость, масштабируемость и безопасность системы.

### 1. api-deployment.yaml
**Описание**: Деплоймент для основного API приложения. Включает 3 реплики для обеспечения отказоустойчивости и масштабируемости.

- **Реплики**: 3
- **Порт**: 8000
- **Дополнительно**: PVC для шаблонов и конфигураций, секреты для базы данных.

### 2. config-deployment.yaml
**Описание**: Деплоймент для микросервиса конфигурации, который управляет настройками системы.

- **Реплики**: 1
- **Порт**: 8080

### 3. encryption-deployment.yaml
**Описание**: Деплоймент для сервиса шифрования. Обеспечивает шифрование данных перед их сохранением в базу.

- **Реплики**: 2
- **Порт**: 8001

### 4. models-deployment.yaml
**Описание**: Деплоймент для взаимодействия с базой данных Cassandra.

- **Реплики**: 2
- **Порт**: 9042

### 5. seal-deployment.yaml
**Описание**: Деплоймент для процесса "распечатывания" хранилища секретов.

- **Реплики**: 1
- **Порт**: 8081
- **Дополнительно**: PVC для хранения ключей.

### 6. hpa.yaml
**Описание**: Манифест для горизонтального авто-масштабирования основного API в зависимости от нагрузки на процессор.

- **Минимум реплик**: 2
- **Максимум реплик**: 10
- **Порог нагрузки**: 80% CPU

### 7. ingress.yaml
**Описание**: Настройка Ingress для маршрутизации трафика и использования TLS для шифрования.

- **Порт**: 80 (HTTP), 443 (HTTPS)
- **TLS-секрет**: secret-app-tls

### 8. key-pvc.yaml
**Описание**: PersistentVolumeClaim для хранения ключей, используемых сервисом Seal.

- **Объем**: 1 GiB
- **Доступ**: ReadWriteOnce

### 9. templates-pvc.yaml
**Описание**: PersistentVolumeClaim для хранения HTML-шаблонов, используемых основным API.

- **Объем**: 1 GiB
- **Доступ**: ReadWriteMany

### 10. certificate.yaml
**Описание**: Манифест для создания TLS-сертификата с использованием Let's Encrypt.

- **Секрет**: secret-app-tls
- **Домен**: localhost

### 11. cluster-issuer.yaml
**Описание**: Настройка ClusterIssuer для автоматической выдачи сертификатов через ACME (Let's Encrypt).

- **ACME сервер**: https://acme-v02.api.letsencrypt.org/directory

### 12. fluentd-config.yaml
**Описание**: Конфигурация Fluentd для сбора логов и отправки их в Elasticsearch.

- **Порт для логов**: 24224
- **Целевой хост**: Elasticsearch

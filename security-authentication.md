# Безопасность и аутентификация

Проект **Secret Vault** использует несколько механизмов для обеспечения безопасности данных, как при их хранении, так и при передаче. Все взаимодействия между сервисами и клиентами защищены с использованием современных методов шифрования и аутентификации.

### 1. TLS (Transport Layer Security)

Для защиты всех данных, передаваемых по сети, используется TLS. Это обеспечивает шифрование соединений между клиентами и сервисами, а также между внутренними сервисами проекта.

- **Файл манифеста**: `ingress.yaml`
- **Используемый сертификат**: Let's Encrypt, автоматическая генерация сертификатов через ClusterIssuer.

TLS обеспечивает:
- Защищённое соединение для всех HTTP-запросов (HTTPS).
- Верификацию подлинности сервера с использованием TLS-сертификатов.

Пример настроек TLS:
```yaml
tls:
  - secretName: secret-app-tls
    hosts:
    - localhost
```

### 2. Аутентификация с помощью токенов

Все запросы от клиентов к серверу требуют аутентификации. Каждый клиент должен предоставить токен, который используется для идентификации пользователя или приложения. Без валидного токена доступ к секретам будет запрещён.

- **Файл манифеста**: `api-deployment.yaml`
- **Механизм**:
  - Каждый запрос сопровождается заголовком `Authorization: Bearer <token>`.
  - Сервер проверяет валидность токена перед обработкой запроса.

### 3. Взаимная аутентификация между сервисами

Для обеспечения безопасности при обмене данными между микросервисами используется механизм взаимной аутентификации (mTLS). Это означает, что каждый сервис проверяет подлинность других сервисов перед установлением соединения.

- **Файл манифеста**: `certificate.yaml`
- **Основные задачи**:
  - Сервисы обмениваются сертификатами для проверки подлинности.
  - Обеспечивается защита от несанкционированного доступа между сервисами.

### 4. Защита данных в состоянии покоя (Data at Rest)

Все секреты, хранящиеся в системе, защищены с использованием шифрования данных в состоянии покоя. Это предотвращает возможность утечки информации даже в случае несанкционированного доступа к базе данных или файловому хранилищу.

- **Файл манифеста**: `encryption-deployment.yaml`
- **Механизм**:
  - Перед сохранением все данные шифруются с использованием алгоритмов симметричного шифрования.
  - Ключи для шифрования хранятся в надёжно защищённом хранилище.

### 5. Политики безопасности

Для защиты системы и данных используются гибкие политики безопасности. Они включают управление доступом к секретам на основе ролей и разрешений.

- **Основные политики**:
  - Только аутентифицированные пользователи могут взаимодействовать с системой.
  - Доступ к конкретным секретам регулируется на уровне ролей.
  - Каждая операция логируется для проведения аудита.

### 6. Ведение журнала аудита

Система ведёт подробный журнал всех операций с секретами и запросов, что позволяет проводить аудит действий пользователей и служб.

- **Файл манифеста**: `audit-policy.yaml`
- **Основные задачи**:
  - Логирование всех действий с секретами, включая добавление, удаление и обновление.
  - Логирование запросов к API для отслеживания аутентификации и авторизации.

Пример политики аудита:
```yaml
apiVersion: audit.k8s.io/v1
kind: Policy
rules:
  - level: Metadata
```


# Структура проекта

Проект разделён на несколько микросервисов, каждый из которых развёрнут в отдельном Docker-контейнере. Компоненты управляются с помощью Kubernetes, обеспечивая отказоустойчивость, масштабируемость и безопасность. Также проект включает несколько конфигурационных файлов, манифестов и HTML-шаблонов для графического интерфейса.

## Основная структура проекта:

```
/project-root
├── api-deployment.yaml
├── config-deployment.yaml
├── encryption-deployment.yaml
├── fluentd-config.yaml
├── hpa.yaml
├── ingress.yaml
├── key-pvc.yaml
├── models-deployment.yaml
├── seal-deployment.yaml
├── templates-pvc.yaml
├── templates/
│   ├── add_secret.html
│   ├── base.html
│   ├── cabinet.html
│   ├── index.html
│   ├── login.html
│   ├── register.html
│   └── secret_list.html
├── Docker/
│   ├── api/
│   ├── config/
│   ├── encryption/
│   ├── models/
│   └── seal/
```

### Описание файлов и манифестов:

**api-deployment.yaml** — это файл деплоймента для основного API, который управляет секретами. Включает 3 реплики для отказоустойчивости и монтирует PersistentVolumeClaim для хранения шаблонов и конфигураций. Применяются секреты для доступа к базе данных, и настроены пробы для мониторинга состояния приложения.

**config-deployment.yaml** — деплоймент конфигурационного сервиса, который управляет настройками системы. Включает одну реплику, так как высокой отказоустойчивости не требуется, и работает на порту 8080.

**encryption-deployment.yaml** — сервис для шифрования данных, включая шифрование секретов. Включает 2 реплики для отказоустойчивости и использует порт 8001.

**models-deployment.yaml** — сервис для взаимодействия с базой данных (например, Cassandra). Включает 2 реплики и использует порт 9042 для связи с базой данных.

**seal-deployment.yaml** — управляет процессом распечатывания (unseal) хранилища секретов. Включает 1 реплику и монтирует ключ через PersistentVolumeClaim.

**hpa.yaml** — манифест для горизонтального авто-масштабирования основного API. Увеличивает количество подов в зависимости от нагрузки на CPU (при достижении 80%).

**ingress.yaml** — настройка Ingress для управления внешним трафиком и обеспечения HTTPS. Используется сертификат TLS для защиты на `localhost`.

**key-pvc.yaml** — PersistentVolumeClaim для хранения ключей, которые используются сервисом `seal`. Хранилище размером 1Gi с доступом `ReadWriteOnce`.

**templates-pvc.yaml** — PersistentVolumeClaim для хранения HTML-шаблонов, которые используются основным API. Хранилище размером 1Gi с доступом `ReadWriteMany`.

**fluentd-config.yaml** — конфигурация Fluentd для сбора логов и отправки их в Elasticsearch через порт 9200.

**audit-policy.yaml** — политика для ведения аудита в Kubernetes. Логирует метаданные запросов.

**certificate.yaml** — настройка TLS-сертификата через Let's Encrypt для использования HTTPS. Сертификат создаётся для `localhost`.

**cluster-issuer.yaml** — ClusterIssuer для автоматической выдачи сертификатов через Let's Encrypt.

### Шаблоны HTML (templates/):

- **add_secret.html** — форма для добавления нового секрета.
- **base.html** — основной шаблон, общий для всех страниц (шапка и подвал).
- **cabinet.html** — личный кабинет пользователя, где отображаются секреты.
- **index.html** — главная страница приложения.
- **login.html** — страница для входа в систему.
- **register.html** — страница регистрации нового пользователя.
- **secret_list.html** — список всех секретов пользователя.
